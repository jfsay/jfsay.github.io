---
title: "自己动手使用Excel来计算数量、单价和总金额"
date: 2011-07-02
categories: 
  - "software_programming"
tags: 
  - "excel"
---

假设我是一个每日需要去菜场批发蔬菜的菜贩，每天进货回来就把货物的金额和数量记在小本本上以供核对。然而整天拿着计算器按来按去总是会出错而且效率不高，于是想借助Excel来完成这个繁琐的任务。

由于政府大力打击投机倒把、哄抬物价的行为以维持物价的稳定，而且我所购买的蔬菜卖家又都是老主顾，所以在一定时期内菜价比较稳定。

下图就是我的功能需求.

![Excel来计算数量、单价和总金额](/images/5893502854_9b07cd513e_z.jpg)<!--more-->

6月1日，我进货白菜、胡萝卜、花菜分别为为100千克，50千克，80千克，这时我需要计算当日总金额，当然我们不需要拿着计算器来加减乘除，我们使用Excel自带的函数来实现。

![Excel来计算数量、单价和总金额](/images/5893501960_673d01b534_z.jpg)

当日的金额的计算公式是：品类A的价格×数量+品类B的价格×数量+品类C的价格×数量

也就是白菜的金额（2.44×100）+胡萝卜的金额（2.88×50）+花菜的金额（3.56×80）

![Excel来计算数量、单价和总金额](/images/5893501442_9b347a1b2b_z.jpg)

也可以这么来看，就是价格行的值和数量行的值交叉相乘然后相加。这时我们使用SUMPRODUCT函数来实现。

![Excel来计算数量、单价和总金额](/images/5892933895_03d469f36d_z.jpg)

我们需要在6.1日的“当日总金额”里显示总金额，做如下步骤：

1、  首先鼠标点击该单元格（E3）

2、  点击函数按钮（fx）

3、  在“数学与三角函数”中选择SUMPRODUCT函数

![Excel来计算数量、单价和总金额](/images/5893502260_f028345a1c_z.jpg)

在“函数参数”对话框中，array1中输入b1:d1，也就是价格行。array2中输入b3:d3，也就是6月1日这天的进货数量行。

![Excel来计算数量、单价和总金额](/images/5892932701_145e7e7a78_z.jpg)

以此类推，6.2到6.7日的总金额也是同样的设置。

下面就来计算6.1到6.7日白菜的数量总和，其实就是白菜列的数量相加，具体的操作步骤和上述差不多。在第3步中选择“常用函数”下的SUM函数。

![Excel来计算数量、单价和总金额](/images/5892933291_03290a3309_z.jpg)

![Excel来计算数量、单价和总金额](/images/5893502418_4037e68fc2_z.jpg)

在弹出来的“函数参数”对话框中，array1中输入b3:b9.

![Excel来计算数量、单价和总金额](/images/5892932885_bf36effb76_z.jpg)

下面来计算6.1到6.7日白菜的金额总计，也就是白菜的数量总和×白菜的价格。在第3步中选择“数学与三角函数”下的MMUIT函数。

![Excel来计算数量、单价和总金额](/images/5893501724_86eb1a364d_z.jpg)

参数中填入b1和b10.

![Excel来计算数量、单价和总金额](/images/5893502576_20e239d976_z.jpg)

胡萝卜和花菜的数量总计和金额总计是相似的操作。

最后来设置绿色区域的单元格。上面一份绿色单元格用来显示6.1到6.7日所有金额的总计，也就是“当日总金额“列的累加，使用SUM函数。

![Excel来计算数量、单价和总金额](/images/5893502736_ae3f1a9af3_z.jpg)

下面一份的绿色单元格用来显示“金额总计”行的金额总计，同样使用SUM函数。

![Excel来计算数量、单价和总金额](/images/5892933035_6eba36273c_z.jpg)

绿色区域上下部分的数值相同则表示整个表格的数值计算正确。

![Excel来计算数量、单价和总金额](/images/5893501860_36297ddd57_z.jpg)

附上[该演示EXCEL下载](https://docs.google.com/leaf?id=0BzfAoPI6tSspOTRmZjFmNjUtYTIwNi00OGFiLWE2ZTYtNzY5YzYyM2M0OGE1&hl=en_US)。
